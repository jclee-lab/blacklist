(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[942],{209:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});var s=a(5155);function l(e){let{title:t,description:a,icon:l,actions:i}=e;return(0,s.jsx)("div",{className:"mb-8",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[l&&(0,s.jsx)("div",{className:"p-3 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl text-white shadow-lg",children:(0,s.jsx)(l,{className:"h-8 w-8"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:t}),(0,s.jsx)("p",{className:"text-gray-600 mt-1",children:a})]})]}),i&&(0,s.jsx)("div",{className:"flex items-center space-x-3",children:i})]})})}},2330:(e,t,a)=>{Promise.resolve().then(a.bind(a,5726))},2529:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},3136:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});var s=a(5155),l=a(9559);function i(e){let{message:t="로딩 중...",size:a="md"}=e;return(0,s.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,s.jsx)(l.A,{className:"".concat({sm:"h-5 w-5",md:"h-8 w-8",lg:"h-12 w-12"}[a]," animate-spin text-blue-500")}),t&&(0,s.jsx)("span",{className:"ml-3 text-gray-600",children:t})]})}},5726:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>A});var s=a(5155),l=a(2115),i=a(7910);let r={ip_address:"",reason:"",source:"MANUAL",country:"",is_active:!0,detection_date:"",removal_date:""};var n=a(7621),c=a(1847);let d=(0,c.A)("layers",[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]]),o=(0,c.A)("shield-check",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),x=(0,c.A)("shield-alert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);function m(e){let{activeTab:t,onTabChange:a}=e;return(0,s.jsx)("div",{className:"flex gap-4 border-b border-gray-200",children:[{id:"unified",label:"통합 뷰",icon:d,activeClass:"border-blue-500 text-blue-600"},{id:"whitelist",label:"화이트리스트",icon:o,activeClass:"border-green-500 text-green-600"},{id:"blacklist",label:"블랙리스트",icon:x,activeClass:"border-red-500 text-red-600"}].map(e=>{let{id:l,label:i,icon:r,activeClass:n}=e;return(0,s.jsxs)("button",{onClick:()=>a(l),className:"px-6 py-3 font-medium border-b-2 transition flex items-center gap-2 ".concat(t===l?n:"border-transparent text-gray-500 hover:text-gray-700"),children:[(0,s.jsx)(r,{className:"h-4 w-4"}),i]},l)})})}var p=a(6651),u=a(9867);let h=(0,c.A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);function y(e){let{activeTab:t,filterType:a,searchIP:l,isDownloading:i,onFilterTypeChange:r,onSearchIPChange:n,onSearch:c,onReset:d,onDownload:o,onAdd:x}=e;return(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:["unified"===t&&(0,s.jsxs)("select",{value:a,onChange:e=>r(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg",children:[(0,s.jsx)("option",{value:"",children:"전체"}),(0,s.jsx)("option",{value:"whitelist",children:"화이트리스트만"}),(0,s.jsx)("option",{value:"blacklist",children:"블랙리스트만"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 flex-1 max-w-md",children:[(0,s.jsx)("input",{type:"text",placeholder:"IP 주소 검색...",value:l,onChange:e=>n(e.target.value),onKeyPress:e=>"Enter"===e.key&&c(),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg"}),(0,s.jsx)("button",{onClick:c,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition",children:(0,s.jsx)(p.A,{className:"h-5 w-5"})}),l&&(0,s.jsx)("button",{onClick:d,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition",children:"초기화"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 ml-auto",children:[(0,s.jsxs)("button",{onClick:o,disabled:i,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition flex items-center gap-2 disabled:opacity-50",children:[(0,s.jsx)(u.A,{className:"h-5 w-5"}),i?"다운로드 중...":"Raw Data"]}),"unified"!==t&&(0,s.jsxs)("button",{onClick:x,className:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition flex items-center gap-2",children:[(0,s.jsx)(h,{className:"h-5 w-5"}),"추가"]})]})]})}var g=a(2529),b=a(8874);let v=(0,c.A)("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),j=(0,c.A)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);function f(e){let{activeTab:t,data:a,loading:l,page:i,total:r,totalPages:n,onPageChange:c,onEdit:d,onDelete:o}=e,x="blacklist"===t||"unified"===t;return l?(0,s.jsx)("div",{className:"p-8 text-center text-gray-500",children:"로딩 중..."}):0===a.length?(0,s.jsx)("div",{className:"p-8 text-center text-gray-500",children:"데이터가 없습니다"}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:["unified"===t&&(0,s.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"구분"}),(0,s.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"IP"}),(0,s.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"사유"}),(0,s.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"소스"}),(0,s.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"국가"}),x&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"상태"}),(0,s.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"탐지일"}),(0,s.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"해제일"})]}),(0,s.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"등록일"}),"unified"!==t&&(0,s.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"작업"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:["unified"===t&&(0,s.jsx)("td",{className:"px-4 py-3 text-sm",children:"whitelist"===e.list_type?(0,s.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800",children:"화이트"}):(0,s.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800",children:"블랙"})}),(0,s.jsx)("td",{className:"px-4 py-3 text-sm font-mono",children:e.ip_address}),(0,s.jsx)("td",{className:"px-4 py-3 text-sm max-w-xs",title:e.reason,children:(0,s.jsx)("div",{className:"whitespace-normal break-words",children:e.reason})}),(0,s.jsx)("td",{className:"px-4 py-3 text-sm",children:e.source}),(0,s.jsx)("td",{className:"px-4 py-3 text-sm",children:e.country||"-"}),x&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("td",{className:"px-4 py-3 text-sm",children:void 0!==e.is_active&&(e.is_active?(0,s.jsx)(g.A,{className:"h-5 w-5 text-green-500 inline"}):(0,s.jsx)(b.A,{className:"h-5 w-5 text-gray-400 inline"}))}),(0,s.jsx)("td",{className:"px-4 py-3 text-sm whitespace-nowrap",children:e.detection_date?new Date(e.detection_date).toLocaleDateString("ko-KR"):"-"}),(0,s.jsx)("td",{className:"px-4 py-3 text-sm whitespace-nowrap",children:e.removal_date?new Date(e.removal_date).toLocaleDateString("ko-KR"):"-"})]}),(0,s.jsx)("td",{className:"px-4 py-3 text-sm whitespace-nowrap",children:e.created_at?new Date(e.created_at).toLocaleDateString("ko-KR"):"-"}),"unified"!==t&&(0,s.jsx)("td",{className:"px-4 py-3 text-sm",children:(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>d(e),className:"text-blue-600 hover:text-blue-800",children:(0,s.jsx)(v,{className:"h-4 w-4"})}),(0,s.jsx)("button",{type:"button",onClick:()=>o(e),className:"text-red-600 hover:text-red-800","aria-label":"".concat(e.ip_address," 삭제"),children:(0,s.jsx)(j,{className:"h-4 w-4"})})]})})]},e.id))})]})}),n>1&&(0,s.jsxs)("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"text-sm text-gray-600",children:["총 ",r,"개 (페이지 ",i,"/",n,")"]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[i>1&&(0,s.jsx)("button",{onClick:()=>c(i-1),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"이전"}),i<n&&(0,s.jsx)("button",{onClick:()=>c(i+1),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"다음"})]})]})]})}function w(e){let{isOpen:t,isEdit:a,activeTab:l,listType:i,formData:r,isSubmitting:n,onFormChange:c,onSubmit:d,onClose:o}=e;return t?(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",role:"dialog","aria-modal":"true","aria-labelledby":"form-modal-title",onKeyDown:e=>"Escape"===e.key&&!n&&o(),children:(0,s.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[(0,s.jsx)("h2",{id:"form-modal-title",className:"text-xl font-bold mb-4",children:a?"".concat("whitelist"===i?"화이트리스트":"블랙리스트"," 수정"):"".concat("whitelist"===l?"화이트리스트":"블랙리스트"," 추가")}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"IP 주소 *"}),(0,s.jsx)("input",{type:"text",value:r.ip_address,onChange:e=>(e=>{let t=e.replace(/(\d{1,3})\.?(\d{1,3})?\.?(\d{1,3})?\.?(\d{1,3})?/,(e,t,a,s,l)=>[t,a,s,l].filter(Boolean).join("."));c({...r,ip_address:t})})(e.target.value),placeholder:"192.168.1.1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["사유 ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)("input",{type:"text",value:r.reason,onChange:e=>c({...r,reason:e.target.value}),placeholder:"whitelist"===l?"VIP 고객":"악성 활동",className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"소스"}),(0,s.jsxs)("select",{value:r.source,onChange:e=>c({...r,source:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[(0,s.jsx)("option",{value:"MANUAL",children:"수동 입력"}),(0,s.jsx)("option",{value:"REGTECH",children:"REGTECH"}),(0,s.jsx)("option",{value:"AUTO",children:"자동"})]})]}),a&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"국가 코드"}),(0,s.jsx)("input",{type:"text",value:r.country,onChange:e=>c({...r,country:e.target.value}),maxLength:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),("blacklist"===i||"blacklist"===l)&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{children:(0,s.jsxs)("label",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:r.is_active,onChange:e=>c({...r,is_active:e.target.checked}),className:"rounded"}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"활성화"})]})}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["탐지일 ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)("input",{type:"date",value:r.detection_date,onChange:e=>(e=>{if(e){let t=new Date(e);t.setMonth(t.getMonth()+3);let a=t.toISOString().split("T")[0];c({...r,detection_date:e,removal_date:a})}else c({...r,detection_date:e})})(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["해제일 (자동: 탐지일 + 3개월) ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)("input",{type:"date",value:r.removal_date,onChange:e=>c({...r,removal_date:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50",placeholder:"탐지일 입력 시 자동 계산됩니다",required:!0})]})]})]}),(0,s.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,s.jsx)("button",{onClick:d,disabled:n,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:n?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),a?"수정 중...":"추가 중..."]}):a?"수정":"추가"}),(0,s.jsx)("button",{onClick:o,disabled:n,className:"flex-1 px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 disabled:opacity-50",children:"취소"})]})]})}):null}function N(e){let{isOpen:t,record:a,onConfirm:l,onClose:i}=e;return t&&a?(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:i,onKeyDown:e=>"Escape"===e.key&&i(),children:(0,s.jsxs)("div",{role:"dialog","aria-modal":"true","aria-labelledby":"delete-modal-title",className:"bg-white rounded-lg p-6 w-full max-w-sm",onClick:e=>e.stopPropagation(),children:[(0,s.jsx)("h2",{id:"delete-modal-title",className:"text-xl font-bold mb-4 text-gray-900",children:"삭제 확인"}),(0,s.jsxs)("p",{className:"text-gray-600 mb-6",children:["정말로 ",(0,s.jsx)("span",{className:"font-mono font-semibold",children:a.ip_address}),"를 삭제하시겠습니까?"]}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)("button",{type:"button",onClick:l,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition",children:"삭제"}),(0,s.jsx)("button",{type:"button",onClick:i,className:"flex-1 px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition",children:"취소"})]})]})}):null}function k(){let{activeTab:e,data:t,loading:a,page:i,total:c,totalPages:d,showAddModal:o,showEditModal:x,showDeleteModal:p,editingRecord:u,deletingRecord:h,formData:g,isSubmitting:b,submitSuccess:v,submitError:j,filterType:k,searchIP:_,isDownloading:C,setPage:A,setFormData:S,setFilterType:M,setSearchIP:T,changeTab:L,fetchData:D,handleAdd:R,handleEdit:z,handleDelete:E,openEditModal:P,confirmDelete:O,downloadRawData:q,openAddModal:I,closeAddModal:V,closeEditModal:U,closeDeleteModal:F}=function(){let[e,t]=(0,l.useState)("unified"),[a,s]=(0,l.useState)([]),[i,c]=(0,l.useState)(!1),[d,o]=(0,l.useState)(1),[x,m]=(0,l.useState)(0),[p,u]=(0,l.useState)(0),[h,y]=(0,l.useState)(!1),[g,b]=(0,l.useState)(!1),[v,j]=(0,l.useState)(!1),[f,w]=(0,l.useState)(null),[N,k]=(0,l.useState)(null),[_,C]=(0,l.useState)(r),[A,S]=(0,l.useState)(!1),[M,T]=(0,l.useState)(!1),[L,D]=(0,l.useState)(null),[R,z]=(0,l.useState)(""),[E,P]=(0,l.useState)(""),[O,q]=(0,l.useState)(!1),I=(0,l.useCallback)(async()=>{c(!0);try{let l,i=new URLSearchParams({page:d.toString(),limit:"20"});if("unified"===e?(R&&i.append("type",R),E&&i.append("ip",E),l=await (0,n.$I)(i.toString())):l="whitelist"===e?await (0,n.Ml)(i.toString()):await (0,n.ex)(i.toString()),l&&!1!==l.success){var t,a;let e=(null==(t=l.data)?void 0:t.items)||l.data||[],i=(null==(a=l.data)?void 0:a.pagination)||l.pagination||{};s(e),m(i.total||0),u(i.total_pages||i.pages||0)}}catch(e){console.error("Fetch error:",e)}finally{c(!1)}},[e,d,R,E]);(0,l.useEffect)(()=>{I()},[I]);let V=(0,l.useCallback)(()=>{C(r),D(null)},[]),U=async()=>{S(!0),D(null);try{let t="whitelist"===e||"unified"===e?"whitelist":"blacklist",a={ip_address:_.ip_address,reason:_.reason,source:_.source,country:_.country||null};"blacklist"===t&&(a.is_active=_.is_active,_.detection_date&&(a.detection_date=_.detection_date),_.removal_date&&(a.removal_date=_.removal_date));let s=await (0,n.VO)(t,a);s.success?(T(!0),y(!1),V(),I(),setTimeout(()=>T(!1),3e3)):D(s.error||"알 수 없는 오류가 발생했습니다.")}catch(e){D("추가 실패: ".concat(e))}finally{S(!1)}},F=async()=>{if(f){S(!0),D(null);try{let e="whitelist"===f.list_type?"whitelist":"blacklist",t={ip_address:_.ip_address,reason:_.reason,source:_.source,country:_.country||null};"blacklist"===e&&(t.is_active=_.is_active,_.detection_date&&(t.detection_date=_.detection_date),_.removal_date&&(t.removal_date=_.removal_date));let a=await (0,n.PH)(e,f.id,t);a.success?(T(!0),b(!1),w(null),V(),I(),setTimeout(()=>T(!1),3e3)):D(a.error||"알 수 없는 오류가 발생했습니다.")}catch(e){D("수정 실패: ".concat(e))}finally{S(!1)}}},H=async()=>{if(N)try{let t="whitelist"===N.list_type||"whitelist"===e?"whitelist":"blacklist",a=await (0,n.V7)(t,N.id);a.success?(T(!0),j(!1),k(null),I(),setTimeout(()=>T(!1),3e3)):(D(a.error||"삭제에 실패했습니다."),setTimeout(()=>D(null),5e3))}catch(e){D("삭제 실패: ".concat(e)),setTimeout(()=>D(null),5e3)}finally{j(!1),k(null)}},K=async()=>{q(!0);try{let t=new URLSearchParams;"blacklist"===e&&t.append("active_only","false");let a=await (0,n.Ab)(t.toString());if(!a)throw Error("Download failed");let s=window.URL.createObjectURL(a),l=document.createElement("a");l.href=s,l.download="blacklist_raw_data_".concat(new Date().toISOString().split("T")[0],".csv"),document.body.appendChild(l),l.click(),window.URL.revokeObjectURL(s),document.body.removeChild(l)}catch(e){D("다운로드 실패: ".concat(e)),setTimeout(()=>D(null),5e3)}finally{q(!1)}};return{activeTab:e,data:a,loading:i,page:d,total:x,totalPages:p,showAddModal:h,showEditModal:g,showDeleteModal:v,editingRecord:f,deletingRecord:N,formData:_,isSubmitting:A,submitSuccess:M,submitError:L,filterType:R,searchIP:E,isDownloading:O,setPage:o,setFormData:C,setFilterType:z,setSearchIP:P,changeTab:e=>{t(e),o(1)},fetchData:I,handleAdd:U,handleEdit:F,handleDelete:H,openEditModal:e=>{w(e),C({ip_address:e.ip_address,reason:e.reason,source:e.source,country:e.country||"",is_active:void 0===e.is_active||e.is_active,detection_date:e.detection_date||"",removal_date:e.removal_date||""}),D(null),b(!0)},confirmDelete:e=>{k(e),j(!0)},downloadRawData:K,openAddModal:()=>{y(!0),V()},closeAddModal:()=>{y(!1),V()},closeEditModal:()=>{b(!1),w(null),V()},closeDeleteModal:()=>{j(!1),k(null)}}}();return(0,s.jsxs)("div",{className:"space-y-6",children:[v&&(0,s.jsx)("div",{className:"rounded-md bg-green-50 p-4",children:(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)("svg",{className:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),(0,s.jsx)("div",{className:"ml-3",children:(0,s.jsxs)("p",{className:"text-sm font-medium text-green-800",children:["whitelist"===e?"화이트리스트":"블랙리스트"," 항목이 성공적으로 추가/수정되었습니다."]})})]})}),j&&(0,s.jsx)("div",{className:"rounded-md bg-red-50 p-4",children:(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,s.jsx)("div",{className:"ml-3",children:(0,s.jsxs)("p",{className:"text-sm font-medium text-red-800",children:["오류: ",j]})})]})}),(0,s.jsx)(m,{activeTab:e,onTabChange:L}),(0,s.jsx)(y,{activeTab:e,filterType:k,searchIP:_,isDownloading:C,onFilterTypeChange:M,onSearchIPChange:T,onSearch:D,onReset:()=>{T(""),A(1),setTimeout(()=>D(),0)},onDownload:q,onAdd:I}),(0,s.jsx)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,s.jsx)(f,{activeTab:e,data:t,loading:a,page:i,total:c,totalPages:d,onPageChange:A,onEdit:P,onDelete:O})}),(0,s.jsx)(w,{isOpen:o,isEdit:!1,activeTab:e,listType:"whitelist"===e?"whitelist":"blacklist",formData:g,isSubmitting:b,onFormChange:S,onSubmit:R,onClose:V}),(0,s.jsx)(w,{isOpen:x,isEdit:!0,activeTab:e,listType:(null==u?void 0:u.list_type)==="whitelist"?"whitelist":"blacklist",formData:g,isSubmitting:b,onFormChange:S,onSubmit:z,onClose:U}),(0,s.jsx)(N,{isOpen:p,record:h,onConfirm:E,onClose:F})]})}var _=a(209),C=a(3136);function A(){return(0,s.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,s.jsx)(_.A,{title:"IP 관리",description:"화이트리스트 및 블랙리스트 통합 관리",icon:i.A}),(0,s.jsx)(l.Suspense,{fallback:(0,s.jsx)(C.A,{message:"데이터 로딩 중..."}),children:(0,s.jsx)(k,{})})]})}},6651:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},7621:(e,t,a)=>{"use strict";a.d(t,{$I:()=>N,Ab:()=>A,DT:()=>o,Dq:()=>g,GT:()=>r,Lz:()=>w,Ml:()=>c,PH:()=>_,Rq:()=>p,SI:()=>y,V7:()=>C,VO:()=>k,_n:()=>v,ex:()=>m,g5:()=>x,iy:()=>n,jN:()=>d,mT:()=>S,nZ:()=>h,o5:()=>j,qS:()=>f,qf:()=>M,rr:()=>b,w_:()=>u});var s=a(5125);let l=s.A.create({baseURL:"/api",timeout:6e4,headers:{"Content-Type":"application/json","Cache-Control":"no-store",Pragma:"no-cache",Expires:"0"}}),i=s.A.create({baseURL:"/api",timeout:3e5,headers:{"Content-Type":"application/json"}}),r=async()=>{let{data:e}=await l.get("/dashboard/stats");return e},n=async()=>{let{data:e}=await l.get("/dashboard/status");return e},c=async e=>{let{data:t}=await l.get(e?"/ip-management/whitelist?".concat(e):"/ip-management/whitelist");return t},d=async()=>{let{data:e}=await l.get("/collection/status");return e},o=async e=>{let{data:t}=await l.get(e?"/collection/history?".concat(e):"/collection/history");return t},x=async()=>{let{data:e}=await l.get("/collection/statistics");return e},m=async e=>{let{data:t}=await l.get(e?"/ip-management/blacklist?".concat(e):"/ip-management/blacklist");return t},p=async()=>{let{data:e}=await l.get("/blacklist/stats");return e},u=async e=>{let{data:t}=await l.get("/collection/credentials/".concat(e));return t},h=async(e,t)=>{let{data:a}=await l.put("/collection/credentials/".concat(e),t);return a},y=async e=>{let{data:t}=await l.post("/collection/credentials/".concat(e,"/test"));return t},g=async()=>{let{data:e}=await l.get("/database/tables");return e},b=async()=>{let{data:e}=await l.get("/database/schema");return e},v=async(e,t)=>{let a=t?"/database/table/".concat(e,"?").concat(t):"/database/table/".concat(e),{data:s}=await l.get(a);return s},j=async e=>{let{data:t}=await l.get(e?"/fortinet/active-ips?".concat(e):"/fortinet/active-ips");return t},f=async e=>{let{data:t}=await l.get(e?"/fortinet/pull-logs?".concat(e):"/fortinet/pull-logs");return t},w=async()=>await l.get("/fortinet/blocklist",{responseType:"text",transformResponse:[e=>{try{return JSON.parse(e)}catch(t){return e}}]}),N=async e=>{let{data:t}=await l.get(e?"/ip-management/unified?".concat(e):"/ip-management/unified");return t},k=async(e,t)=>{let{data:a}=await l.post("/ip-management/".concat(e),t);return a},_=async(e,t,a)=>{let{data:s}=await l.put("/ip-management/".concat(e,"/").concat(t),a);return s},C=async(e,t)=>{let{data:a}=await l.delete("/ip-management/".concat(e,"/").concat(t));return a},A=async e=>(await l.get(e?"/blacklist/export-raw?".concat(e):"/blacklist/export-raw",{responseType:"blob"})).data,S=async(e,t)=>{let{data:a}=await i.post("/collection/".concat(e,"/trigger"),t||{});return a},M=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30,{data:t}=await l.get("/analytics/detection-timeline?days=".concat(e));return t}},7910:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},8874:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},9559:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},9867:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]])}},e=>{e.O(0,[211,441,255,358],()=>e(e.s=2330)),_N_E=e.O()}]);