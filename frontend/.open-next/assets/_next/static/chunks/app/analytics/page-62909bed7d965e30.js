(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[745],{368:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},534:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]])},1524:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]])},2056:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},5511:(e,t,a)=>{Promise.resolve().then(a.bind(a,7849))},6485:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},7621:(e,t,a)=>{"use strict";a.d(t,{$I:()=>w,Ab:()=>M,DT:()=>o,Dq:()=>y,GT:()=>c,Lz:()=>f,Ml:()=>i,PH:()=>_,Rq:()=>h,SI:()=>u,V7:()=>A,VO:()=>k,_n:()=>j,ex:()=>m,g5:()=>x,iy:()=>r,jN:()=>d,mT:()=>S,nZ:()=>g,o5:()=>N,qS:()=>v,qf:()=>C,rr:()=>b,w_:()=>p});var s=a(5125);let l=s.A.create({baseURL:"/api",timeout:6e4,headers:{"Content-Type":"application/json","Cache-Control":"no-store",Pragma:"no-cache",Expires:"0"}}),n=s.A.create({baseURL:"/api",timeout:3e5,headers:{"Content-Type":"application/json"}}),c=async()=>{let{data:e}=await l.get("/dashboard/stats");return e},r=async()=>{let{data:e}=await l.get("/dashboard/status");return e},i=async e=>{let{data:t}=await l.get(e?"/ip-management/whitelist?".concat(e):"/ip-management/whitelist");return t},d=async()=>{let{data:e}=await l.get("/collection/status");return e},o=async e=>{let{data:t}=await l.get(e?"/collection/history?".concat(e):"/collection/history");return t},x=async()=>{let{data:e}=await l.get("/collection/statistics");return e},m=async e=>{let{data:t}=await l.get(e?"/ip-management/blacklist?".concat(e):"/ip-management/blacklist");return t},h=async()=>{let{data:e}=await l.get("/blacklist/stats");return e},p=async e=>{let{data:t}=await l.get("/collection/credentials/".concat(e));return t},g=async(e,t)=>{let{data:a}=await l.put("/collection/credentials/".concat(e),t);return a},u=async e=>{let{data:t}=await l.post("/collection/credentials/".concat(e,"/test"));return t},y=async()=>{let{data:e}=await l.get("/database/tables");return e},b=async()=>{let{data:e}=await l.get("/database/schema");return e},j=async(e,t)=>{let a=t?"/database/table/".concat(e,"?").concat(t):"/database/table/".concat(e),{data:s}=await l.get(a);return s},N=async e=>{let{data:t}=await l.get(e?"/fortinet/active-ips?".concat(e):"/fortinet/active-ips");return t},v=async e=>{let{data:t}=await l.get(e?"/fortinet/pull-logs?".concat(e):"/fortinet/pull-logs");return t},f=async()=>await l.get("/fortinet/blocklist",{responseType:"text",transformResponse:[e=>{try{return JSON.parse(e)}catch(t){return e}}]}),w=async e=>{let{data:t}=await l.get(e?"/ip-management/unified?".concat(e):"/ip-management/unified");return t},k=async(e,t)=>{let{data:a}=await l.post("/ip-management/".concat(e),t);return a},_=async(e,t,a)=>{let{data:s}=await l.put("/ip-management/".concat(e,"/").concat(t),a);return s},A=async(e,t)=>{let{data:a}=await l.delete("/ip-management/".concat(e,"/").concat(t));return a},M=async e=>(await l.get(e?"/blacklist/export-raw?".concat(e):"/blacklist/export-raw",{responseType:"blob"})).data,S=async(e,t)=>{let{data:a}=await n.post("/collection/".concat(e,"/trigger"),t||{});return a},C=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30,{data:t}=await l.get("/analytics/detection-timeline?days=".concat(e));return t}},7849:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>h});var s=a(5155),l=a(2115),n=a(9559),c=a(534),r=a(6485),i=a(1524),d=a(2056),o=a(368),x=a(7937),m=a(7621);function h(){var e,t,a,h,p,g;let[u,y]=(0,l.useState)(null),[b,j]=(0,l.useState)(!0),[N,v]=(0,l.useState)(30),[f,w]=(0,l.useState)(1),k=(0,l.useCallback)(async()=>{j(!0);try{let e=await (0,m.qf)(N);y(e),w(1)}catch(e){console.error("Failed to fetch analytics:",e)}finally{j(!1)}},[N]);(0,l.useEffect)(()=>{k()},[k]);let _=(null==u||null==(e=u.data)?void 0:e.timeline)||[],A=null==u||null==(t=u.data)?void 0:t.metadata,M=(null==u||null==(a=u.data)?void 0:a.source_statistics)||[],S=null==u||null==(h=u.data)?void 0:h.suspicious_analysis,C=Math.ceil(_.length/15),L=_.slice((f-1)*15,15*f),q=Math.max(..._.map(e=>e.ip_count),1);return(0,s.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("h1",{className:"text-4xl font-bold bg-gradient-to-r from-gray-900 via-gray-800 to-gray-900 bg-clip-text text-transparent mb-3",children:"일별 탐지 통계"}),(0,s.jsx)("p",{className:"text-gray-600 text-lg",children:"탐지일 기준 IP 수집 현황 분석"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)("select",{value:N,onChange:e=>v(Number(e.target.value)),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:7,children:"최근 7일"}),(0,s.jsx)("option",{value:14,children:"최근 14일"}),(0,s.jsx)("option",{value:30,children:"최근 30일"}),(0,s.jsx)("option",{value:60,children:"최근 60일"}),(0,s.jsx)("option",{value:90,children:"최근 90일"})]}),(0,s.jsxs)("button",{onClick:k,disabled:b,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[(0,s.jsx)(n.A,{className:"h-4 w-4 ".concat(b?"animate-spin":"")}),(0,s.jsx)("span",{children:"새로고침"})]})]}),A&&(0,s.jsxs)("div",{className:"text-sm text-gray-500",children:["생성: ",new Date(A.generated_at).toLocaleString("ko-KR")]})]}),b?(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[1,2,3,4].map(e=>(0,s.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-lg animate-pulse",children:[(0,s.jsx)("div",{className:"h-12 bg-gray-200 rounded mb-4"}),(0,s.jsx)("div",{className:"h-8 bg-gray-200 rounded"})]},e))}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[(0,s.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,s.jsx)("div",{className:"bg-blue-500 p-2 rounded-lg",children:(0,s.jsx)(c.A,{className:"h-5 w-5 text-white"})}),(0,s.jsx)("span",{className:"text-gray-600 text-sm",children:"총 IP 수"})]}),(0,s.jsx)("p",{className:"text-3xl font-bold text-gray-900",children:(null==A||null==(p=A.total_ips)?void 0:p.toLocaleString())||0})]}),(0,s.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,s.jsx)("div",{className:"bg-green-500 p-2 rounded-lg",children:(0,s.jsx)(r.A,{className:"h-5 w-5 text-white"})}),(0,s.jsx)("span",{className:"text-gray-600 text-sm",children:"활성 일수"})]}),(0,s.jsxs)("p",{className:"text-3xl font-bold text-gray-900",children:[(null==A?void 0:A.total_days)||0,"일"]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,s.jsx)("div",{className:"bg-purple-500 p-2 rounded-lg",children:(0,s.jsx)(i.A,{className:"h-5 w-5 text-white"})}),(0,s.jsx)("span",{className:"text-gray-600 text-sm",children:"일평균"})]}),(0,s.jsx)("p",{className:"text-3xl font-bold text-gray-900",children:(null==A||null==(g=A.avg_per_day)?void 0:g.toLocaleString())||0})]}),(0,s.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,s.jsx)("div",{className:"p-2 rounded-lg ".concat(((null==S?void 0:S.suspicious_days_count)||0)>0?"bg-red-500":"bg-gray-400"),children:(0,s.jsx)(d.A,{className:"h-5 w-5 text-white"})}),(0,s.jsx)("span",{className:"text-gray-600 text-sm",children:"수상한 패턴"})]}),(0,s.jsxs)("p",{className:"text-3xl font-bold ".concat(((null==S?void 0:S.suspicious_days_count)||0)>0?"text-red-600":"text-gray-900"),children:[(null==S?void 0:S.suspicious_days_count)||0,"일"]})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-8",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"일별 수집 현황"}),(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"border-b border-gray-200",children:[(0,s.jsx)("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"탐지일"}),(0,s.jsx)("th",{className:"text-right py-3 px-4 text-sm font-semibold text-gray-600",children:"IP 수"}),(0,s.jsx)("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"분포"}),(0,s.jsx)("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"소스"}),(0,s.jsx)("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"상태"})]})}),(0,s.jsx)("tbody",{children:L.map((e,t)=>(0,s.jsxs)("tr",{className:"border-b border-gray-100 hover:bg-gray-50 ".concat(e.is_suspicious?"bg-red-50":""),children:[(0,s.jsx)("td",{className:"py-3 px-4",children:(0,s.jsx)("span",{className:"font-medium text-gray-900",children:e.detection_day})}),(0,s.jsx)("td",{className:"py-3 px-4 text-right",children:(0,s.jsx)("span",{className:"font-bold text-gray-900",children:e.ip_count.toLocaleString()})}),(0,s.jsx)("td",{className:"py-3 px-4",children:(0,s.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,s.jsx)("div",{className:"h-2.5 rounded-full ".concat(e.is_suspicious?"bg-red-500":"bg-blue-500"),style:{width:"".concat(e.ip_count/q*100,"%")}})})}),(0,s.jsx)("td",{className:"py-3 px-4",children:(0,s.jsx)("span",{className:"text-sm text-gray-600",children:e.sources})}),(0,s.jsx)("td",{className:"py-3 px-4 text-center",children:e.is_suspicious?(0,s.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[(0,s.jsx)(d.A,{className:"h-3 w-3 mr-1"}),"수상"]}):(0,s.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"정상"})})]},t))})]})}),C>1&&(0,s.jsxs)("div",{className:"flex items-center justify-between mt-4 pt-4 border-t border-gray-200",children:[(0,s.jsxs)("span",{className:"text-sm text-gray-600",children:[_.length,"개 중 ",(f-1)*15+1,"-",Math.min(15*f,_.length)]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("button",{onClick:()=>w(e=>Math.max(1,e-1)),disabled:1===f,className:"p-2 rounded-lg border border-gray-300 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:(0,s.jsx)(o.A,{className:"h-4 w-4"})}),(0,s.jsxs)("span",{className:"text-sm text-gray-600",children:[f," / ",C]}),(0,s.jsx)("button",{onClick:()=>w(e=>Math.min(C,e+1)),disabled:f===C,className:"p-2 rounded-lg border border-gray-300 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:(0,s.jsx)(x.A,{className:"h-4 w-4"})})]})]})]}),M.length>0&&(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"소스별 통계"}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:M.map((e,t)=>(0,s.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg",children:[(0,s.jsx)("h3",{className:"font-bold text-gray-900 mb-2",children:e.source}),(0,s.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-600",children:"총 IP"}),(0,s.jsx)("span",{className:"font-medium",children:e.total_ips.toLocaleString()})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-600",children:"활성일"}),(0,s.jsxs)("span",{className:"font-medium",children:[e.active_days,"일"]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-600",children:"일평균"}),(0,s.jsx)("span",{className:"font-medium",children:e.avg_per_day})]})]})]},t))})]})]})]})}},7937:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},9559:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])}},e=>{e.O(0,[211,441,255,358],()=>e(e.s=5511)),_N_E=e.O()}]);