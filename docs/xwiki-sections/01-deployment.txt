= (% id="H1" %)ğŸ“˜ 1. ì˜¤í”„ë¼ì¸ ë°°í¬ ê°€ì´ë“œ =

{{panel title="**âœ¨ ì´ ì„¹ì…˜ì—ì„œ ë°°ìš¸ ë‚´ìš©**"}}
* â˜‘ï¸ 2-íŒŒì¼ íŒ¨í‚¤ì§€ êµ¬ì„± ë° ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­
* â˜‘ï¸ 10ë¶„ ìë™ ì„¤ì¹˜ ì ˆì°¨ (install.sh)
* â˜‘ï¸ Traefik ì—°ë™ ì„¤ì •
* â˜‘ï¸ ì¼ìƒ ìš´ì˜ ê´€ë¦¬ (ì‹œì‘/ì¤‘ì§€/ë°±ì—…/ë¡œê·¸)
{{/panel}}

---

== 1ï¸âƒ£ ë°°í¬ ë°©ì‹ ==

{{success}}
**ğŸ¯ ê¶Œì¥ ë°°í¬: ì—ì–´ê°­ (Air-Gap) 2-íŒŒì¼ ë°©ì‹**
* **ì¸í„°ë„· ë¶ˆí•„ìš”**: ì™„ì „ ì˜¤í”„ë¼ì¸ ì„¤ì¹˜ (~10-15ë¶„)
* **íŒŒì¼ 2ê°œë§Œ**: blacklist.tar.gz + install.sh
* **ë³´ì•ˆ**: ì™¸ë¶€ ë„¤íŠ¸ì›Œí¬ ì°¨ë‹¨, ë‚´ë¶€ë§ ì „ìš©
* **íŒ¨í‚¤ì§€ í¬ê¸°**: 813MB (v3.3.7)
{{/success}}

=== 1.1 ğŸ“¦ íŒ¨í‚¤ì§€ êµ¬ì„± ===

{{info}}
**ğŸ¯ 2-íŒŒì¼ íŒ¨í‚¤ì§€ íŠ¹ì§• (v3.3.7)**
* **íŒŒì¼**: {{code}}blacklist.tar.gz{{/code}} (813MB) + {{code}}install.sh{{/code}} (20KB)
* **ì„¤ì¹˜ ì‹œê°„**: (% style="color:#4CAF50; font-weight:bold;" %)10-15ë¶„(%)
* **ì¸í„°ë„·**: (% style="color:#4CAF50; font-weight:bold;" %)âŒ ë¶ˆí•„ìš”(%)
* **ë²„ì „**: 3.3.7 (2025-10-29)
* **ì„œë¹„ìŠ¤**: 5ê°œ ì»¨í…Œì´ë„ˆ (nginx ì œê±°)
{{/info}}

**ğŸ“‚ blacklist.tar.gz ë‚´ìš©:**

{{code language="bash"}}
blacklist.tar.gz (813MB)
â”œâ”€â”€ ğŸ³ docker-images/            # 5ê°œ Docker ì´ë¯¸ì§€
â”‚   â”œâ”€â”€ blacklist-app(ë‚ ì§œ).tar     # ğŸ Flask API (455MB)
â”‚   â”œâ”€â”€ blacklist-collector(ë‚ ì§œ).tar # ğŸ“Š ìˆ˜ì§‘ê¸° (1.5GB)
â”‚   â”œâ”€â”€ blacklist-postgres(ë‚ ì§œ).tar  # ğŸ˜ PostgreSQL 15 (265MB)
â”‚   â”œâ”€â”€ blacklist-redis(ë‚ ì§œ).tar     # ğŸ”´ Redis 7 (41MB)
â”‚   â””â”€â”€ blacklist-frontend(ë‚ ì§œ).tar  # âš›ï¸  Next.js (206MB)
â”œâ”€â”€ ğŸ“‚ config/
â”‚   â”œâ”€â”€ docker-compose.yml       # ì„œë¹„ìŠ¤ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜
â”‚   â”œâ”€â”€ .env.example             # í™˜ê²½ë³€ìˆ˜ í…œí”Œë¦¿
â”‚   â””â”€â”€ migrations/              # 17ê°œ SQL ë§ˆì´ê·¸ë ˆì´ì…˜
â””â”€â”€ ğŸ“š docs/
    â””â”€â”€ xwiki-sections/          # XWiki ë¬¸ì„œ (14ê°œ)
{{/code}}

{{warning}}
**âš ï¸ Traefik ë³„ë„ ì„¤ì¹˜ í•„ìš”**
* Traefikì€ íŒ¨í‚¤ì§€ì— í¬í•¨ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤
* ì„¤ì¹˜ ì „ì— Traefik ë¨¼ì € ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤
* ê°€ì´ë“œ: {{code}}docs/TRAEFIK-SETUP.md{{/code}}
{{/warning}}

=== 1.2 ğŸ’» ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­ ===

(% class="wikitable" %)
|=(% style="background:#607D8B; color:white;" %)í•­ëª©|=(% style="background:#607D8B; color:white;" %)ìµœì†Œ ìš”êµ¬ì‚¬í•­|=(% style="background:#607D8B; color:white;" %)âœ… ê¶Œì¥ì‚¬ì–‘
|**OS**|RHEL 8.8 / Ubuntu 20.04+|(% style="color:#4CAF50; font-weight:bold;" %)RHEL 8.8 / Rocky Linux 9(%)
|**CPU**|4 Core|(% style="color:#4CAF50; font-weight:bold;" %)8 Core(%)
|**RAM**|8GB|(% style="color:#4CAF50; font-weight:bold;" %)16GB(%)
|**Disk**|50GB (SSD)|(% style="color:#4CAF50; font-weight:bold;" %)100GB (SSD)(%)
|**Docker**|20.10+|(% style="color:#4CAF50; font-weight:bold;" %)24.0+(%)
|**Docker Compose**|2.0+|(% style="color:#4CAF50; font-weight:bold;" %)2.20+(%)
|**Traefik**|v2.10+|(% style="color:#4CAF50; font-weight:bold;" %)ë³„ë„ ì„¤ì¹˜(%)

{{warning}}
**âš ï¸ ì¤‘ìš”**: SSD ì‚¬ìš© ê°•ë ¥ ê¶Œì¥. HDD ì‚¬ìš© ì‹œ DB ì„±ëŠ¥ ì €í•˜ ë°œìƒ.
{{/warning}}

---

== 2ï¸âƒ£ ì„¤ì¹˜ ì ˆì°¨ ==

=== 2.1 ğŸš€ Traefik ë¨¼ì € ì„¤ì¹˜ (í•„ìˆ˜) ===

{{error}}
**â— ì¤‘ìš”: Traefikì„ ë¨¼ì € ì„¤ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤**
{{/error}}

{{code language="bash"}}
# â‘  Traefik ë””ë ‰í† ë¦¬ ìƒì„±
mkdir -p /home/jclee/infrastructure/traefik/{config,ssl}

# â‘¡ SSL ì¸ì¦ì„œ ë³µì‚¬
cp /path/to/cert.crt /home/jclee/infrastructure/traefik/ssl/default.crt
cp /path/to/key.key /home/jclee/infrastructure/traefik/ssl/default.key
chmod 600 /home/jclee/infrastructure/traefik/ssl/*.key

# â‘¢ docker-compose.yml ì‘ì„±
# (docs/TRAEFIK-SETUP.md ì°¸ê³ )

# â‘£ Traefik ì‹œì‘
cd /home/jclee/infrastructure/traefik
docker compose up -d

# â‘¤ ë„¤íŠ¸ì›Œí¬ ìƒì„± (ìë™ìœ¼ë¡œ ìƒì„±ë˜ì§€ë§Œ í™•ì¸)
docker network ls | grep traefik-public

# â‘¥ Traefik í™•ì¸
docker ps | grep traefik
docker logs traefik
{{/code}}

{{success}}
**âœ… Traefik ì„¤ì¹˜ ì™„ë£Œ í™•ì¸**
* {{code}}docker ps{{/code}}ì— traefik ì»¨í…Œì´ë„ˆ í‘œì‹œ
* {{code}}docker network ls{{/code}}ì— traefik-public ë„¤íŠ¸ì›Œí¬ í‘œì‹œ
{{/success}}

=== 2.2 ğŸ“¦ Blacklist íŒ¨í‚¤ì§€ ì„¤ì¹˜ ===

{{success}}
**ğŸ‰ ìë™ ì„¤ì¹˜**: {{code}}install.sh{{/code}} ì‹¤í–‰ìœ¼ë¡œ ëª¨ë“  ê³¼ì • ìë™ ì™„ë£Œ
{{/success}}

{{code language="bash"}}
# â‘  íŒ¨í‚¤ì§€ ì „ì†¡ (ì—ì–´ê°­ í™˜ê²½)
scp blacklist.tar.gz install.sh user@target:/opt/

# â‘¡ ì„¤ì¹˜ ë””ë ‰í† ë¦¬ ì´ë™
cd /opt

# â‘¢ ìë™ ì„¤ì¹˜ ì‹¤í–‰
bash install.sh

# â‘£ ì„¤ì¹˜ ê³¼ì • (ìë™)
# - Preflight ì²´í¬ (Docker, ë””ìŠ¤í¬, í¬íŠ¸)
# - íŒ¨í‚¤ì§€ ì••ì¶• í•´ì œ (813MB)
# - Docker ì´ë¯¸ì§€ ë¡œë“œ (5ê°œ ì„œë¹„ìŠ¤)
# - ë°ì´í„° ë””ë ‰í† ë¦¬ ìƒì„±
# - DB ë§ˆì´ê·¸ë ˆì´ì…˜ (17ê°œ SQL)
# - í™˜ê²½ë³€ìˆ˜ ì„¤ì • (.env)
# - ì„œë¹„ìŠ¤ ì‹œì‘ (docker compose)
# - í—¬ìŠ¤ì²´í¬ (6ê°œ í…ŒìŠ¤íŠ¸)

# â‘¤ ì„¤ì¹˜ ì™„ë£Œ (10-15ë¶„)
{{/code}}

**ğŸ¬ ì„¤ì¹˜ í™”ë©´ ì˜ˆì‹œ:**

{{code}}
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  Blacklist Installation v3.3.7        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[STEP 1/8] Preflight Checks
  âœ“ Docker installed (24.0.7)
  âœ“ Docker Compose installed (2.20.3)
  âœ“ Disk space: 85GB available
  âœ“ Ports available: 2542, 2543, 8545

[STEP 2/8] Extract Package (813MB)
  âœ“ blacklist.tar.gz extracted

[STEP 3/8] Load Docker Images (5 services)
  âœ“ blacklist-app loaded (455MB)
  âœ“ blacklist-collector loaded (1.5GB)
  âœ“ blacklist-postgres loaded (265MB)
  âœ“ blacklist-redis loaded (41MB)
  âœ“ blacklist-frontend loaded (206MB)

[STEP 4/8] Create Data Directories
  âœ“ /data/postgres created
  âœ“ /data/redis created

[STEP 5/8] Database Migrations (17 SQL)
  âœ“ All migrations applied

[STEP 6/8] Environment Configuration
  âœ“ .env created

[STEP 7/8] Start Services
  âœ“ blacklist-postgres (healthy)
  âœ“ blacklist-redis (healthy)
  âœ“ blacklist-collector (healthy)
  âœ“ blacklist-app (healthy)
  âœ“ blacklist-frontend (healthy)

[STEP 8/8] Health Checks
  âœ“ API health: 200 OK
  âœ“ DB connection: OK
  âœ“ Redis connection: OK

âœ… Installation Complete!
   URL: https://blacklist.nxtd.co.kr
   Time: 12m 34s
{{/code}}

=== 2.3 ğŸ” ì„¤ì¹˜ í™•ì¸ ===

{{code language="bash"}}
# â‘  ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸
docker ps

# ì˜ˆìƒ ì¶œë ¥ (5ê°œ ì»¨í…Œì´ë„ˆ)
# blacklist-frontend    (healthy)
# blacklist-app         (healthy)
# blacklist-collector   (healthy)
# blacklist-postgres    (healthy)
# blacklist-redis       (healthy)

# â‘¡ ë„¤íŠ¸ì›Œí¬ í™•ì¸
docker network ls | grep -E "(blacklist-network|traefik-public)"

# â‘¢ API í—¬ìŠ¤ì²´í¬
curl http://localhost:2542/health
# ì‘ë‹µ: {"status": "healthy", "database": "connected", "redis": "connected"}

# â‘£ ì›¹ ì ‘ì† (Traefik í†µí•´)
curl -k https://blacklist.nxtd.co.kr
{{/code}}

{{success}}
**âœ… ì„¤ì¹˜ ì„±ê³µ í™•ì¸ ê¸°ì¤€**
* 5ê°œ ì»¨í…Œì´ë„ˆ ëª¨ë‘ (% style="color:#4CAF50;" %)**(healthy)**(%) ìƒíƒœ
* API í—¬ìŠ¤ì²´í¬ {{code}}200 OK{{/code}}
* ì›¹ UI ì ‘ì† ê°€ëŠ¥ (https://blacklist.nxtd.co.kr)
{{/success}}

---

== 3ï¸âƒ£ ì¼ìƒ ìš´ì˜ ==

=== 3.1 ğŸš€ ì„œë¹„ìŠ¤ ê´€ë¦¬ ===

{{code language="bash"}}
# ì‹œì‘
docker compose up -d

# ì¤‘ì§€
docker compose down

# ì¬ì‹œì‘
docker compose restart

# íŠ¹ì • ì„œë¹„ìŠ¤ë§Œ ì¬ì‹œì‘
docker compose restart blacklist-app

# ìƒíƒœ í™•ì¸
docker compose ps
{{/code}}

=== 3.2 ğŸ“Š ë¡œê·¸ í™•ì¸ ===

{{code language="bash"}}
# ì „ì²´ ë¡œê·¸ (ì‹¤ì‹œê°„)
docker compose logs -f

# íŠ¹ì • ì„œë¹„ìŠ¤ ë¡œê·¸
docker compose logs -f blacklist-app

# ìµœê·¼ 100ì¤„
docker compose logs --tail=100 blacklist-app

# íƒ€ì„ìŠ¤íƒ¬í”„ í¬í•¨
docker compose logs -f --timestamps blacklist-app
{{/code}}

=== 3.3 ğŸ’¾ ë°±ì—… ===

{{code language="bash"}}
# â‘  ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—…
docker exec blacklist-postgres pg_dump -U postgres blacklist > backup_$(date +%Y%m%d).sql

# â‘¡ Redis ë°±ì—… (ìë™ RDB)
docker exec blacklist-redis redis-cli SAVE
cp /data/redis/dump.rdb backup_redis_$(date +%Y%m%d).rdb

# â‘¢ ì„¤ì • íŒŒì¼ ë°±ì—…
tar -czf backup_config_$(date +%Y%m%d).tar.gz docker-compose.yml .env
{{/code}}

=== 3.4 ğŸ”„ ë³µì› ===

{{code language="bash"}}
# â‘  DB ë³µì›
docker exec -i blacklist-postgres psql -U postgres blacklist < backup_20251029.sql

# â‘¡ Redis ë³µì›
docker compose down
cp backup_redis_20251029.rdb /data/redis/dump.rdb
docker compose up -d
{{/code}}

---

== 4ï¸âƒ£ ì—…ê·¸ë ˆì´ë“œ ==

=== 4.1 ğŸ“¦ íŒ¨í‚¤ì§€ ì—…ê·¸ë ˆì´ë“œ ===

{{code language="bash"}}
# â‘  ê¸°ì¡´ ì„œë¹„ìŠ¤ ì¤‘ì§€
cd /opt/blacklist
docker compose down

# â‘¡ ë°ì´í„° ë°±ì—… (ì¤‘ìš”!)
docker exec blacklist-postgres pg_dump -U postgres blacklist > backup_before_upgrade.sql

# â‘¢ ìƒˆ íŒ¨í‚¤ì§€ ì„¤ì¹˜
bash install.sh

# â‘£ ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜ (ìë™)
# install.shê°€ ìë™ ì‹¤í–‰

# â‘¤ ì„œë¹„ìŠ¤ ì‹œì‘ (ìë™)
# install.shê°€ ìë™ ì‹¤í–‰
{{/code}}

{{warning}}
**âš ï¸ ì—…ê·¸ë ˆì´ë“œ ì „ í•„ìˆ˜ ì‘ì—…**
* DB ë°±ì—… í•„ìˆ˜
* ë‹¤ìš´íƒ€ì„ ê³µì§€ (ì•½ 10-15ë¶„)
* í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œ ë¨¼ì € ê²€ì¦ ê¶Œì¥
{{/warning}}

---

== 5ï¸âƒ£ íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ==

=== 5.1 ğŸ› ì¼ë°˜ì ì¸ ë¬¸ì œ ===

==== ë¬¸ì œ 1: ì»¨í…Œì´ë„ˆê°€ ì‹œì‘í•˜ì§€ ì•ŠìŒ ====

{{code language="bash"}}
# ì›ì¸ í™•ì¸
docker compose logs blacklist-app

# í”í•œ ì›ì¸:
# - DB ì—°ê²° ì‹¤íŒ¨ â†’ postgres ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸
# - í¬íŠ¸ ì¶©ëŒ â†’ ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ê°€ í¬íŠ¸ ì‚¬ìš© ì¤‘
# - í™˜ê²½ë³€ìˆ˜ ëˆ„ë½ â†’ .env íŒŒì¼ í™•ì¸

# í•´ê²°:
docker compose ps blacklist-postgres  # DB ìƒíƒœ
docker logs blacklist-postgres         # DB ë¡œê·¸
netstat -tulpn | grep -E "(2542|2543|8545)"  # í¬íŠ¸ í™•ì¸
{{/code}}

==== ë¬¸ì œ 2: ì›¹ UI ì ‘ì† ë¶ˆê°€ ====

{{code language="bash"}}
# Traefik í™•ì¸
docker ps | grep traefik
docker logs traefik | grep blacklist

# ë„¤íŠ¸ì›Œí¬ í™•ì¸
docker network inspect traefik-public
docker inspect blacklist-frontend | grep -A 5 Networks

# Frontend ë¡œê·¸ í™•ì¸
docker logs blacklist-frontend
{{/code}}

==== ë¬¸ì œ 3: ë°ì´í„° ìˆ˜ì§‘ ì‹¤íŒ¨ ====

{{code language="bash"}}
# Collector ë¡œê·¸ í™•ì¸
docker logs blacklist-collector | grep -i error

# ìˆ˜ì§‘ ìƒíƒœ í™•ì¸ (API)
curl http://localhost:2542/api/collection/status

# ìˆ˜ì§‘ ì¸ì¦ ì •ë³´ í™•ì¸ (DB)
docker exec blacklist-postgres psql -U postgres -d blacklist \
  -c "SELECT source_type, is_active FROM collection_credentials;"
{{/code}}

=== 5.2 ğŸ“‹ ì§„ë‹¨ ëª…ë ¹ì–´ ===

{{code language="bash"}}
# ì „ì²´ ì‹œìŠ¤í…œ ìƒíƒœ
docker compose ps
docker compose logs --tail=50

# ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰
docker stats --no-stream

# ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰
df -h
du -sh /data/*

# ë„¤íŠ¸ì›Œí¬ í™•ì¸
docker network ls
docker network inspect blacklist-network
docker network inspect traefik-public
{{/code}}

---

== 6ï¸âƒ£ ì°¸ê³  ì •ë³´ ==

=== 6.1 ğŸ“ ì£¼ìš” ë””ë ‰í† ë¦¬ ===

{{code}}
/opt/blacklist/               # ì„¤ì¹˜ ë””ë ‰í† ë¦¬
â”œâ”€â”€ docker-compose.yml        # ì„œë¹„ìŠ¤ ì •ì˜
â”œâ”€â”€ .env                      # í™˜ê²½ë³€ìˆ˜
â”œâ”€â”€ data/                     # ì˜êµ¬ ë°ì´í„°
â”‚   â”œâ”€â”€ postgres/             # DB ë°ì´í„°
â”‚   â””â”€â”€ redis/                # Redis ë°ì´í„°
â””â”€â”€ docs/                     # ë¬¸ì„œ

/home/jclee/infrastructure/traefik/  # Traefik (ë³„ë„)
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ config/tls.yml
â””â”€â”€ ssl/
    â”œâ”€â”€ default.crt
    â””â”€â”€ default.key
{{/code}}

=== 6.2 ğŸ”§ í™˜ê²½ë³€ìˆ˜ (.env) ===

{{code language="bash"}}
# PostgreSQL
POSTGRES_HOST=blacklist-postgres
POSTGRES_PORT=5432
POSTGRES_DB=blacklist
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres

# Redis
REDIS_HOST=blacklist-redis
REDIS_PORT=6379

# Flask
FLASK_ENV=production
PORT=2542

# Collector
COLLECTION_INTERVAL=86400  # 24ì‹œê°„ (ì´ˆ)
HEALTH_CHECK_PORT=8545

# Timezone
TZ=Asia/Seoul
{{/code}}

=== 6.3 ğŸŒ ì£¼ìš” ì—”ë“œí¬ì¸íŠ¸ ===

(% class="wikitable" %)
|=(% style="background:#607D8B; color:white;" %)ì„œë¹„ìŠ¤|=(% style="background:#607D8B; color:white;" %)URL|=(% style="background:#607D8B; color:white;" %)ìš©ë„
|ì›¹ UI|https://blacklist.nxtd.co.kr|ë©”ì¸ ì›¹ ì¸í„°í˜ì´ìŠ¤
|API|http://localhost:2542|REST API (ë‚´ë¶€)
|Collector|http://localhost:8545/health|ìˆ˜ì§‘ê¸° í—¬ìŠ¤ì²´í¬ (ë‚´ë¶€)
|Traefik Dashboard|https://traefik.nxtd.co.kr|Traefik ê´€ë¦¬ (ë³„ë„)

---

**ë‹¤ìŒ ì„¹ì…˜**: [[2. ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜>>doc:blacklist-platform.02-architecture]]
